name: 'Build'
description: 'Build Go packages'
inputs:
  build-make-action:  
    description: 'Action in makefile to build package'
    required: true
  push-make-action:  
    description: 'Action in makefile to push package to docker repo'
    required: true
  
runs:
  using: "composite"
  steps: 
    - name: Test
      run: make test
      shell: bash

    - name: Build docker image
      run: make ${{ inputs.build-make-action }}
      shell: bash

    - name: Push images to private repo
      run: |
        echo "${{ inputs.docker-passw}}" | docker login -u ${{ inputs.docker-user }} --password-stdin dokken.azurecr.io
        make ${{ inputs.push-make-action }}
      shell: bash  
